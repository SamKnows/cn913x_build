From a04543475e6630a5aa21978a0ce39e4622295055 Mon Sep 17 00:00:00 2001
From: Alon Rotman <alon.rotman@solid-run.com>
Date: Tue, 9 Feb 2021 17:12:33 +0200
Subject: [PATCH 05/18] dts: update spi clock frequency to 10MHz

Signed-off-by: Alon Rotman <alon.rotman@solid-run.com>
---
 arch/arm64/boot/dts/marvell/cn9130-cex7.dts | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

diff --git a/arch/arm64/boot/dts/marvell/cn9130-cex7.dts b/arch/arm64/boot/dts/marvell/cn9130-cex7.dts
index 11dc8c323c3a..9636dc01993c 100644
--- a/arch/arm64/boot/dts/marvell/cn9130-cex7.dts
+++ b/arch/arm64/boot/dts/marvell/cn9130-cex7.dts
@@ -346,7 +346,8 @@ &cp0_sdhci0 {
 &cp0_spi1 {
 	status = "okay";
 	pinctrl-names = "default";
-	pinctrl-0 = <&cp0_spi1_pins>;
+	pinctrl-0 = <&cp0_spi1_pins
+			&cp0_spi1_cs1_pins>;
 	reg = <0x700680 0x50>;
 	spi-flash@0 {
 		#address-cells = <0x1>;
@@ -361,7 +362,7 @@ spi-flash@1 {
 		compatible = "jedec,spi-nor";
 		reg = <0x1>;
 		/* On carrier MUX does not allow higher frequencies */
-		spi-max-frequency = <20000000>;
+		spi-max-frequency = <10000000>;
 	};
 };
 
@@ -399,9 +400,14 @@ cp0_sdhci_pins: cp0-sdhi-pins-0 {
 			marvell,function = "sdio";
 		};
 		cp0_spi1_pins: cp0-spi-pins-1 {
-			marvell,pins = "mpp13", "mpp14", "mpp15", "mpp16", "mpp12";
+			marvell,pins = "mpp13", "mpp14", "mpp15", "mpp16";
 			marvell,function = "spi1";
 		};
+		cp0_spi1_cs1_pins: cp0-spi-cs1-pins-1 {
+                        marvell,pins = "mpp12";
+                        marvell,function = "spi1";
+                };
+
 		cp0_sfp_present_pins: sfp-present-pins {
 			marvell,pins = "mpp24";
 			marvell,function = "gpio";
-- 
2.34.1

